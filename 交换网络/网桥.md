#### 直连网络的可扩展性
- 直连网络本质上是一种广播网络, 共享链路, 可扩展性很差
    - 结点数量, 覆盖范围, 性能受限
- 解决办法
    - 分割网络, 引入交换技术
        - 交换, 是允许互联链路以形成更大规模网络的机制
    - 广播->单播, 更强的可扩展性
        - 通过交换机的互联, 扩展结点的数量, 覆盖范围, 性能
## 交换网络
- 设计目标
    - 数据只朝向目的结点方向发送(转发, Forward), 引入交换结点
    - 转发规则是网络自己学习生成的, 不需要外界参与
### 网桥(Bridge)(又叫链路层/二层交换机)

#### 在数据链路层扩展局域网
- 解决共享介质的分组转发问题, 扩展LAN(Local Area Network)的物理范围
- 工作方式:
    - 过滤(filtering)
        - 根据帧的目的地址决定一个帧应该转发到某个接口还是丢弃
        - 目的结点处于接收端口所连接的网段, 丢弃(因为不应该发给自己, 在原网段就能找到目的结点)
    - 转发(forwarding)
        - 根据帧的目的地址决定该将其导向哪个接口, 将帧转发出去
    - 基于转发表/转发数据库(Forwarding DataBase, FDB)实现
- 网桥使各网段成为隔离开的碰撞域
    - 连接异质链路
        - 互联不同物理层, 不同速率的局域网
    - 消除碰撞, 增加网络带宽
        - 单个网段100Mbps, 一个网桥能传输100n Mbps(n为网桥端口数)
        - 网桥可以隔离碰撞域, 但不能隔离广播域
- 数据帧转发
    - 转发表/转发数据库(Forwarding DataBase, FDB)
        - 存储目的MAC地址到 (出) 端口的映射关系
        - e.g. 
        
        |Dest MAC Addr|Port|Age|
        |:----:|:----:|:----:|
        |02:23:c0:01:00:11|1|36|
        |02:23:c0:01:00:22|3|20|
    - 对每个数据帧, 在FDB中查找目的MAC地址对应的端口号
        - 若存在对应端口号, 且与接收端口一致, 丢弃
        - 若存在对应端口号, 且不同于接收端口, 从该端口将数据转发(**单播**)
        - 如果FDB中不存在对应条目, 将该数据包从所有端口转发(**广播**)
- 学习结点位置
    - 每收一个新的数据帧, 记录其源MAC地址和输入端口, 将该映射关系写入FDB表
- 生成树协议(Spanning Tree Protocol)
    - 网络中存在冗余链路(提升网络健壮性等)
        - 网络拓扑由树状结构变成图状结构
        - 数据转发过程中, 形成环路(网络广播风暴)
    - 解决办法
        - 为网络中每对源目的结点分配唯一确定的一条路径
        - 这些路径构成了一棵树(生成树, Spanning Tree)
            - 覆盖所有顶点的无环子图
- 生成树算法
    - 选择一个网桥作生成树的根
        - 如选一个最小序号的网桥
        - 根网桥总在它所有端口上转发分组
    - 其它结点确定根端口
        - 每个网桥计算到根的最短路径, 并记下路径经过它的哪个端口, 将这个端口作为到根的优先路径
    - 为每个局域网选指派网桥
        - 指派网桥负责向根网桥转发帧(网桥之间通过算法确定)